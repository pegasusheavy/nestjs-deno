import{c as E}from"./chunk-2L6TCK4P.js";import{$a as s,Ja as n,Ka as t,La as d,R as m,S as p,Xa as e,Za as a,_a as r,na as i,xa as o}from"./chunk-MJEEDWY6.js";var S=class x{static \u0275fac=function(l){return new(l||x)};static \u0275cmp=o({type:x,selectors:[["app-express-compat"]],decls:478,vars:18,consts:[[1,"max-w-4xl","mx-auto","px-6","py-12"],[1,"prose","prose-invert","max-w-none"],[1,"mb-12","pb-8","border-b","border-dark-500"],[1,"text-4xl","font-bold","text-text-primary","mb-4"],[1,"text-xl","text-text-secondary"],[1,"mb-12"],[1,"text-2xl","font-semibold","text-text-primary","mb-4","flex","items-center","gap-3"],[1,"text-nest-red"],[1,"text-text-secondary","mb-4"],[1,"p-4","bg-dark-800","rounded-lg","border-l-4","border-code-green"],[1,"text-sm","text-text-secondary"],[1,"text-text-primary"],[1,"bg-dark-800","rounded-lg","border","border-dark-500","overflow-hidden","mb-6"],[1,"flex","items-center","justify-between","px-4","py-2","bg-dark-700","border-b","border-dark-500"],[1,"text-xs","text-text-muted"],[1,"p-4","!bg-transparent","!border-0","!m-0"],[1,"text-sm"],[1,"text-code-pink"],[1,"text-code-yellow"],[1,"text-code-green"],[1,"text-text-muted"],[1,"text-code-cyan"],[1,"text-code-orange"],[1,"grid","md:grid-cols-2","gap-6"],[1,"bg-dark-800","rounded-lg","border","border-dark-500","p-4"],[1,"font-semibold","text-text-primary","mb-3","flex","items-center","gap-2"],[1,"space-y-2","text-sm","text-text-secondary"],[1,"flex","items-center","gap-2"],[1,"space-y-6"],[1,"text-lg","font-semibold","text-text-primary","mb-3"],[1,"bg-dark-800","rounded-lg","border","border-dark-500","overflow-hidden"],[1,"space-y-3","text-text-secondary"],[1,"flex","items-start","gap-3"],[1,"text-code-yellow","mt-1"],[1,"p-6","bg-dark-800","rounded-xl","border","border-dark-500"],[1,"text-xl","font-semibold","text-text-primary","mb-4"],[1,"flex","flex-wrap","gap-4"],["routerLink","/fastify-compat",1,"inline-flex","items-center","gap-2","px-4","py-2","bg-nest-red","hover:bg-nest-red-dark","text-white","text-sm","font-medium","rounded-lg","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["routerLink","/api",1,"inline-flex","items-center","gap-2","px-4","py-2","bg-dark-700","hover:bg-dark-600","text-text-primary","text-sm","font-medium","rounded-lg","border","border-dark-500","transition-colors"]],template:function(l,u){l&1&&(n(0,"div",0)(1,"article",1)(2,"header",2)(3,"h1",3),e(4,"Express Middleware Compatibility"),t(),n(5,"p",4),e(6," Use your existing Express middleware with the Deno adapter through our compatibility layer. "),t()(),n(7,"section",5)(8,"h2",6)(9,"span",7),e(10,"\u26A1"),t(),e(11," Overview "),t(),n(12,"p",8),e(13," The Express compatibility layer provides a bridge between Express middleware and the Deno adapter. It wraps Express-style middleware functions and adapts them to work with Deno's native Request/Response objects. "),t(),n(14,"div",9)(15,"p",10)(16,"strong",11),e(17,"Note:"),t(),e(18," Most Express middleware works out of the box. Some middleware that relies on Node.js-specific APIs may require modifications. "),t()()(),n(19,"section",5)(20,"h2",6)(21,"span",7),e(22,"\u{1F4D6}"),t(),e(23," Basic Usage "),t(),n(24,"p",8),e(25," Use the "),n(26,"code"),e(27,"useExpressMiddleware"),t(),e(28," method to register Express middleware: "),t(),n(29,"div",12)(30,"div",13)(31,"span",14),e(32,"main.ts"),t()(),n(33,"pre",15)(34,"code",16)(35,"span",17),e(36,"import"),t(),e(37),n(38,"span",17),e(39,"from"),t(),e(40," "),n(41,"span",18),e(42,"'@nestjs/core'"),t(),e(43,`;
`),n(44,"span",17),e(45,"import"),t(),e(46),n(47,"span",17),e(48,"from"),t(),e(49," "),n(50,"span",18),e(51,"'@pegasusheavy/nestjs-platform-deno'"),t(),e(52,`;
`),n(53,"span",17),e(54,"import"),t(),e(55," helmet "),n(56,"span",17),e(57,"from"),t(),e(58," "),n(59,"span",18),e(60,"'helmet'"),t(),e(61,`;
`),n(62,"span",17),e(63,"import"),t(),e(64," compression "),n(65,"span",17),e(66,"from"),t(),e(67," "),n(68,"span",18),e(69,"'compression'"),t(),e(70,`;

`),n(71,"span",17),e(72,"const"),t(),e(73," adapter = "),n(74,"span",17),e(75,"new"),t(),e(76," "),n(77,"span",19),e(78,"DenoAdapter"),t(),e(79,`();

`),n(80,"span",20),e(81,"// Register Express middleware"),t(),e(82,`
adapter.`),n(83,"span",21),e(84,"useExpressMiddleware"),t(),e(85,"("),n(86,"span",21),e(87,"helmet"),t(),e(88,`());
adapter.`),n(89,"span",21),e(90,"useExpressMiddleware"),t(),e(91,"("),n(92,"span",21),e(93,"compression"),t(),e(94,`());

`),n(95,"span",17),e(96,"const"),t(),e(97," app = "),n(98,"span",17),e(99,"await"),t(),e(100," NestFactory."),n(101,"span",21),e(102,"create"),t(),e(103,`(AppModule, adapter);
`),n(104,"span",17),e(105,"await"),t(),e(106," app."),n(107,"span",21),e(108,"listen"),t(),e(109,"("),n(110,"span",22),e(111,"3000"),t(),e(112,");"),t()()()(),n(113,"section",5)(114,"h2",6)(115,"span",7),e(116,"\u{1F527}"),t(),e(117," Manual Wrapping "),t(),n(118,"p",8),e(119," For more control, use the "),n(120,"code"),e(121,"wrapExpressMiddleware"),t(),e(122," function directly: "),t(),n(123,"div",12)(124,"pre",15)(125,"code",16)(126,"span",17),e(127,"import"),t(),e(128),n(129,"span",17),e(130,"from"),t(),e(131," "),n(132,"span",18),e(133,"'@pegasusheavy/nestjs-platform-deno'"),t(),e(134,`;
`),n(135,"span",17),e(136,"import"),t(),e(137," morgan "),n(138,"span",17),e(139,"from"),t(),e(140," "),n(141,"span",18),e(142,"'morgan'"),t(),e(143,`;

`),n(144,"span",20),e(145,"// Wrap the middleware"),t(),e(146,`
`),n(147,"span",17),e(148,"const"),t(),e(149," loggerMiddleware = "),n(150,"span",21),e(151,"wrapExpressMiddleware"),t(),e(152,"("),n(153,"span",21),e(154,"morgan"),t(),e(155,"("),n(156,"span",18),e(157,"'combined'"),t(),e(158,`));

`),n(159,"span",20),e(160,"// Use with the adapter"),t(),e(161,`
adapter.`),n(162,"span",21),e(163,"use"),t(),e(164,"(loggerMiddleware);"),t()()()(),n(165,"section",5)(166,"h2",6)(167,"span",7),e(168,"\u2705"),t(),e(169," Supported Express APIs "),t(),n(170,"p",8),e(171," The compatibility layer implements the following Express request and response APIs: "),t(),n(172,"div",23)(173,"div",24)(174,"h3",25)(175,"span",21),e(176,"Request"),t()(),n(177,"ul",26)(178,"li",27)(179,"span",19),e(180,"\u2713"),t(),n(181,"code"),e(182,"req.body"),t()(),n(183,"li",27)(184,"span",19),e(185,"\u2713"),t(),n(186,"code"),e(187,"req.params"),t()(),n(188,"li",27)(189,"span",19),e(190,"\u2713"),t(),n(191,"code"),e(192,"req.query"),t()(),n(193,"li",27)(194,"span",19),e(195,"\u2713"),t(),n(196,"code"),e(197,"req.headers"),t()(),n(198,"li",27)(199,"span",19),e(200,"\u2713"),t(),n(201,"code"),e(202,"req.cookies"),t()(),n(203,"li",27)(204,"span",19),e(205,"\u2713"),t(),n(206,"code"),e(207,"req.method"),t()(),n(208,"li",27)(209,"span",19),e(210,"\u2713"),t(),n(211,"code"),e(212,"req.url / req.path"),t()(),n(213,"li",27)(214,"span",19),e(215,"\u2713"),t(),n(216,"code"),e(217,"req.get(header)"),t()(),n(218,"li",27)(219,"span",19),e(220,"\u2713"),t(),n(221,"code"),e(222,"req.is(type)"),t()(),n(223,"li",27)(224,"span",19),e(225,"\u2713"),t(),n(226,"code"),e(227,"req.accepts()"),t()()()(),n(228,"div",24)(229,"h3",25)(230,"span",21),e(231,"Response"),t()(),n(232,"ul",26)(233,"li",27)(234,"span",19),e(235,"\u2713"),t(),n(236,"code"),e(237,"res.status(code)"),t()(),n(238,"li",27)(239,"span",19),e(240,"\u2713"),t(),n(241,"code"),e(242,"res.json(data)"),t()(),n(243,"li",27)(244,"span",19),e(245,"\u2713"),t(),n(246,"code"),e(247,"res.send(data)"),t()(),n(248,"li",27)(249,"span",19),e(250,"\u2713"),t(),n(251,"code"),e(252,"res.set(header, value)"),t()(),n(253,"li",27)(254,"span",19),e(255,"\u2713"),t(),n(256,"code"),e(257,"res.cookie(name, value)"),t()(),n(258,"li",27)(259,"span",19),e(260,"\u2713"),t(),n(261,"code"),e(262,"res.redirect(url)"),t()(),n(263,"li",27)(264,"span",19),e(265,"\u2713"),t(),n(266,"code"),e(267,"res.type(type)"),t()(),n(268,"li",27)(269,"span",19),e(270,"\u2713"),t(),n(271,"code"),e(272,"res.end()"),t()(),n(273,"li",27)(274,"span",19),e(275,"\u2713"),t(),n(276,"code"),e(277,"res.headersSent"),t()(),n(278,"li",27)(279,"span",19),e(280,"\u2713"),t(),n(281,"code"),e(282,"res.locals"),t()()()()()(),n(283,"section",5)(284,"h2",6)(285,"span",7),e(286,"\u{1F4E6}"),t(),e(287," Popular Middleware Examples "),t(),n(288,"div",28)(289,"div")(290,"h3",29),e(291,"Helmet (Security Headers)"),t(),n(292,"div",30)(293,"pre",15)(294,"code",16)(295,"span",17),e(296,"import"),t(),e(297," helmet "),n(298,"span",17),e(299,"from"),t(),e(300," "),n(301,"span",18),e(302,"'helmet'"),t(),e(303,`;

adapter.`),n(304,"span",21),e(305,"useExpressMiddleware"),t(),e(306,"("),n(307,"span",21),e(308,"helmet"),t(),e(309),n(310,"span",18),e(311,`"'self'"`),t(),e(312,`],
      styleSrc: [`),n(313,"span",18),e(314,`"'self'"`),t(),e(315,", "),n(316,"span",18),e(317,`"'unsafe-inline'"`),t(),e(318),t()()()(),n(319,"div")(320,"h3",29),e(321,"Morgan (HTTP Logging)"),t(),n(322,"div",30)(323,"pre",15)(324,"code",16)(325,"span",17),e(326,"import"),t(),e(327," morgan "),n(328,"span",17),e(329,"from"),t(),e(330," "),n(331,"span",18),e(332,"'morgan'"),t(),e(333,`;

adapter.`),n(334,"span",21),e(335,"useExpressMiddleware"),t(),e(336,"("),n(337,"span",21),e(338,"morgan"),t(),e(339,"("),n(340,"span",18),e(341,"'dev'"),t(),e(342,"));"),t()()()(),n(343,"div")(344,"h3",29),e(345,"Cookie Parser"),t(),n(346,"div",30)(347,"pre",15)(348,"code",16)(349,"span",17),e(350,"import"),t(),e(351," cookieParser "),n(352,"span",17),e(353,"from"),t(),e(354," "),n(355,"span",18),e(356,"'cookie-parser'"),t(),e(357,`;

adapter.`),n(358,"span",21),e(359,"useExpressMiddleware"),t(),e(360,"("),n(361,"span",21),e(362,"cookieParser"),t(),e(363,"("),n(364,"span",18),e(365,"'secret'"),t(),e(366,"));"),t()()()(),n(367,"div")(368,"h3",29),e(369,"Rate Limiting"),t(),n(370,"div",30)(371,"pre",15)(372,"code",16)(373,"span",17),e(374,"import"),t(),e(375," rateLimit "),n(376,"span",17),e(377,"from"),t(),e(378," "),n(379,"span",18),e(380,"'express-rate-limit'"),t(),e(381,`;

`),n(382,"span",17),e(383,"const"),t(),e(384," limiter = "),n(385,"span",21),e(386,"rateLimit"),t(),e(387),n(388,"span",22),e(389,"15"),t(),e(390," * "),n(391,"span",22),e(392,"60"),t(),e(393," * "),n(394,"span",22),e(395,"1000"),t(),e(396,", "),n(397,"span",20),e(398,"// 15 minutes"),t(),e(399,`
  max: `),n(400,"span",22),e(401,"100"),t(),e(402,", "),n(403,"span",20),e(404,"// limit each IP to 100 requests"),t(),e(405),n(406,"span",21),e(407,"useExpressMiddleware"),t(),e(408,"(limiter);"),t()()()()()(),n(409,"section",5)(410,"h2",6)(411,"span",7),e(412,"\u{1F6A8}"),t(),e(413," Error Handling Middleware "),t(),n(414,"p",8),e(415," Express-style error handling middleware (4 parameters) is also supported: "),t(),n(416,"div",30)(417,"pre",15)(418,"code",16)(419,"span",17),e(420,"const"),t(),e(421),n(422,"span",21),e(423,"error"),t(),e(424,`(err.stack);
  res.`),n(425,"span",21),e(426,"status"),t(),e(427,"("),n(428,"span",22),e(429,"500"),t(),e(430,")."),n(431,"span",21),e(432,"json"),t(),e(433),n(434,"span",18),e(435,"'Internal Server Error'"),t(),e(436),n(437,"span",21),e(438,"useExpressMiddleware"),t(),e(439,"(errorHandler);"),t()()()(),n(440,"section",5)(441,"h2",6)(442,"span",7),e(443,"\u26A0\uFE0F"),t(),e(444," Known Limitations "),t(),n(445,"ul",31)(446,"li",32)(447,"span",33),e(448,"!"),t(),n(449,"span"),e(450,"Middleware that directly accesses "),n(451,"code"),e(452,"req.socket"),t(),e(453," or Node.js streams may not work"),t()(),n(454,"li",32)(455,"span",33),e(456,"!"),t(),n(457,"span"),e(458,"Session middleware that uses file system storage requires Deno file system permissions"),t()(),n(459,"li",32)(460,"span",33),e(461,"!"),t(),n(462,"span"),e(463,"Middleware that modifies the prototype chain of request/response objects is not supported"),t()()()(),n(464,"section",34)(465,"h2",35),e(466,"See Also"),t(),n(467,"div",36)(468,"a",37)(469,"span"),e(470,"Fastify Compatibility"),t(),m(),n(471,"svg",38),d(472,"path",39),t()(),p(),n(473,"a",40)(474,"span"),e(475,"API Reference"),t(),m(),n(476,"svg",38),d(477,"path",39),t()()()()()()),l&2&&(i(37),r(" ","{"," NestFactory ","}"," "),i(9),r(" ","{"," DenoAdapter ","}"," "),i(82),r(" ","{"," wrapExpressMiddleware ","}"," "),i(181),s("(","{",`
  contentSecurityPolicy: `,"{",`
    directives: `,"{",`
      defaultSrc: [`),i(9),s(`],
    `,"}",`,
  `,"}",`,
`,"}","));"),i(69),a("(","{",`
  windowMs: `),i(18),a(`
`,"}",`);

adapter.`),i(16),a(" errorHandler = (err, req, res, next) => ","{",`
  console.`),i(12),a("(","{",`
    error: `),i(3),r(`,
    message: err.message,
  `,"}",`);
`,"}",`;

adapter.`))},dependencies:[E],encapsulation:2})};export{S as ExpressCompat};
